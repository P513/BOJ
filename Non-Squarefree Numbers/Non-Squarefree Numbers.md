# 문제

A positive integer k is called squarefree if k is not divisible by d2 for any d > 1.

https://www.acmicpc.net/problem/8464

## 문제 분류

수학, 이분 탐색, 정수론, 포함 배제의 원리, 뫼비우스 반전 공식

## 입출력 예시

<table>
  <tr>
    <th>입력</th>
    <th>출력</th>
  </tr>
  <tr>
    <td>10</td>
    <td>27</td>
  </tr>
</table>

# 풀이

이 문제는 제곱 ㄴㄴ수와 반대로 어떤 수의 제곱으로 나눠지는 수를 구하면 된다.

포함 배제의 원리를 사용하면 잘 풀 수 있다.

또한 {-1, 0, 1}을 가지는 뫼비우스 함수를 사용하자.

소인수분해를 생각해보자. 아래와 같은 3가지 경우가 있다.

1) 소인수 분해 시 같은 소수가 2개 이상 존재

N = m^2 * k (k는 임의의 소수, m은 소수) 이다. 따라서 N은 m^2으로 나누어지는 NSN이다. 따라서 0으로 설정한다.

2) 소인수 분해 시 지수의 개수가 홀수

포함 배제의 원리를 적용하여 홀수개는 빼야 하므로 -1로 설정한다.

3) 소인수 분해 시 지수의 개수가 짝수

포함 배제의 원리를 적용하여 짝수개는 더해야 하므로 1로 설정한다.

1은 +1로 더해주고, 나머지는 -1로 설정한다.

num_squarefree 함수에서는 해당하는 숫자 n의 제곱근까지 범위를 설정한다.

그리고 prime[i]에 따라 그 수(제곱수)로 나눠지는 수를 더할지 뺄지 결정한다.

## 나는 ..

무려 다이아 5 티어의 문제이다.

사실 이 문제를 풀 생각이 없었는데 제곱 ㄴㄴ수를 풀고 난 후 비슷하게 풀 수 있다고 해서 풀었다.

풀고 굉장히 만족스러웠던건 사실 제곱 ㄴㄴ수를 풀 때까지만 해도 시간 복잡도 감이 잘 안잡혔다.

https://ohgym.tistory.com/19

이 블로그가 많이 도움이 되었다.

시간 복잡도는 n*log(n)*log(n)이다.

지금은 이 풀이를 이해하였지만 후에 다시 풀어보면 버벅일 거 같다.

비슷한 개념 문제를 더 풀어봐야겠다.